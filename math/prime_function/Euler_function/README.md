# 欧拉函数

## 概述

**欧拉函数**，也称为**欧拉phi函数**，是**数论领域**中的欧拉函数。

欧拉函数的定义为：**对于正整数n，欧拉函数是不大于n的正整数中与n互质的数的个数**。

## 欧拉函数公式

> **phi(n) = n * (1 - 1/p1) * (1 - 1/p2) * (1 - 1/p3) * ··· * (1 - 1/pk)**

也可写做

> **phi(n) = n * ((p1-1) / p1) * ((p2-1) / p2) * ((p3-1) / p3) * ··· * ((pk-1) / pk)**

其中p1, p2, ··· , pk为n分解出的不同的质因数。

## 欧拉函数值的定义

* phi(1) = 1
* 如果n是素数p的k次幂，那么 **phi(n) = p^k - p^(k-1) = (p-1) * p^(k-1)**
* 如果m与n互质，那么 **phi(m*n) = phi(m) * phi(n)**

## ACM竞赛中的欧拉函数的求法

* 求单个数的欧拉函数值

    利用**欧拉函数公式**以及**欧拉函数值的定义**来求，由于需要用到分解质因数，因此代码几乎一样，**时间复杂度为O(√n)**。代码如下
    ```cpp
    int phi(int x)
    {
        int ans = x;
        for (int i=2; i*i<=n; ++i)
        {
            if (x % i == 0)
            {
                ans -= ans / i;         //由 ans = ans * (i - 1) / i; 化简而来
                while (x % i == 0) x /= i;
            }
        }
        if (x > 1) ans -= ans / x;
        return ans;
    }
    ```

* 求欧拉函数表

    筛素数的同时求出欧拉函数表，如同求素数表一样，同样有**埃氏筛**和**线性筛**两种筛法。**建议用线性筛**，**时间复杂度为O(n)**，代码如下
