# 母函数

---

## 概述

**母函数**又称**生成函数**。

在数学中，某个序列$(a_0, a_1, \cdots, a_n)$的母函数是一种**形式幂级数**，其中每一项的系数都可以提供关于这个序列的信息。
构造母函数是为了解决特定的问题。
母函数分为很多种，包括**普通母函数**，**指数母函数**，**L级数**，**贝尔级数**和**狄利克雷级数**。

---

## 普通母函数

### 介绍

对与下面这个多项式乘法

$$(1 + a_{1}x)(1 + a_{2}x)\cdots(1 + a_{n}x) = \\
1 + (a_{1} + a_{2} + \cdots + a_{n})x + \\
(a_{1}a_{2} + a_{1}a_{3} + \cdots + a_{n-1}a_{n})x^2 + \cdots + \\
a_{1}a_{2}\cdots a_{n}x^n$$

我们可以看出

* $x$项系数是从$a_1, a_2, \cdots, a_n$中取出一个元素组合的全体，共有$n$个
* $x^2$项系数是从$a_1, a_2, \cdots, a_n$中取出两个元素组合的全体，共有$C_{n}^{2}$个
* 接下来不用我说了，按照这个规律
* $x^n$项的系数是从$a_1, a_2, \cdots, a_n$中取出$n$个元素组合的全体，共有$C_{n}^{n}$个

如果每个$a_?$的值都设为$1$，那么可以得到

$$(1 + x)^n = 1 + C_{n}^{1}x + C_{n}^{2}x^{2} + \cdots + C_{n}^{n}x^{n}$$

对与序列$a_0, a_1, \cdots, a_n$，构造一个函数

$$G(x) = a_0 + a_1x + a_2x^2 + \cdots + a_nx^n$$

那么函数$G(x)$就称为序列$a_0, a_1, \cdots, a_n$的母函数

比如：$(1 + x)^n$就是序列$C_n^0, C_n^1, \cdots, C_n^n$的母函数

### 应用

例题：有质量分别为$1, 2, 3$的砝码各一枚。

* 可以称多少种不同质量的物体？（不包括$0$）
* 如果要称质量为$3$的物体，有几种方法？

解答：如果我们用$x$来表示物体，$x$的指数来表示物体的质量，那么

质量为$1$的砝码可以用多项式$1 + x$来表示，其中$1$表示质量为$1$的砝码一个都不用（即$x^0$），$x$表示使用$1$个质量为$1$的砝码（即$x^1$）。

质量为$2$的砝码用多项式$1 + x^2$表示，其中$1$依旧是表示质量为$2$的砝码一个都不用（即$x^0$），$x^2$表示使用$1$个质量为$2$的砝码（即$x^2$）。

同理：质量为$3$的砝码用多项式$1 + x^3$表示。

可以构造母函数如下

$$G(x) = (1 + x)(1 + x^2)(1 + x^3) = 1 + x + x^2 + 2x^3 + x^4 + x^5 + x^6$$

从上面构造的母函数可以得出以下信息

* 一共可以称出$6$种质量（$1 \sim 6$，不包括$0$），对应$x^{1 \sim 6}$
* $x^3$的系数为$2$，表示称出质量为$3$的物品有$2$种方案


关于上面例题构造的母函数$G(x) = (1 + x)(1 + x^2)(1 + x^3)$中一共有$3$项，分别为$1 + x$，$1 + x^2$和$1 + x^3$，
每一项的内容都是按照**加法计数原理**计算砝码选择个数的情况，而每一项相乘组成母函数$G(x)$则是遵循**乘法计数原理**。


现在，假设我们把条件改一下，每一种砝码都有无数个，那么这种情况所对应的母函数为

$$G(x) = (1 + x + x^2 + x^3 + \cdots)(1 + x^2 + x^4 + x^6 + \cdots)(1 + x^3 + x^6 + x^9 + \cdots)$$

* 第一项中的$1$代表质量为$1$的砝码没有使用
* 第一项中的$x$代表质量为$1$的砝码使用了$1$个
* 第一项中的$x^2$代表质量为$1$的砝码使用了$2$个
* ······
* 第二项中的$1$代表质量为$2$的砝码没有使用
* 第二项中的$x^2$代表质量为$2$的砝码使用了$1$个
* 第二项中的$x^4$代表质量为$2$的砝码使用了$2$个
* ······

### 代码实现

根据上面第一个例题，我们给出求母函数的如下代码实现，求出母函数每项的系数

```cpp
int coe[N];     // 存储母函数每一项的系数 coe[i] 表示 x^i 的系数
int tmp[N];     // 中间变量
int num[N];     // num[i] 表示质量为i的砝码可以使用的次数

void Generate()
{
    memset(coe, 0, sizeof(coe));
    memset(tmp, 0, sizeof(tmp));
    coe[0] = 1;     // ---------------------------> (1)
    for (int i=1; i<=n; ++i)    // ---------------> (2)
    {
        for (int j=0; j<=m; ++j)    // -----------> (3)
        {
            if (coe[j] == 0) continue;
            for (int k=0; k<num[k]; ++k)    // ---> (4)
            {
                tmp[k * i + j] += coe[j];   // ---> (5)
            }
        }
        memcpy(coe, tmp, sizeof(coe));  // -------> (6)
        memset(tmp, 0, sizeof(tmp));
    }
    return;
}
```

对与上述代码，根据例题中的母函数为$G(x) = (1 + x)(1 + x^2)(1 + x^3)$，要得出结果为$1 + x + x^2 + 2x^3 + x^4 + x^5 + x^6$。

算法步骤及代码解释如下

* (1) 对与多项式，我们先要构造出一个初始化的项$1$

    在这个例题中，即构造出这样的式子$(1)(1 + x)(1 + x^2)(1 + x^3)$

* (2) 枚举每一个多项式

    这个例题中枚举的是$1 + x$，$1 + x^2$和$1 + x^3$

    * (3) 枚举当前`coe`的系数，即$x^{0 \sim m}$的系数

        最开始的`coe`只有$x^0$的系数为$1$，即步骤(1)的初始化，只需要枚举非$0$的系数就行了

        * (4) 枚举该多项式中的系数

            比如第一项$1 + x$的系数分别为$1$（$1$的系数）和$1$（$x$的系数）

            * (5) 计算当前已知多项式与枚举的多项式相乘的结果并存储到中间变量数组中

                在这里最开始是计算$(1)(1 + x) = 1 + x$
                后面我们会依次计算$(1 + x)(1 + x^2) = 1 + x + x^2 + x^3$
                再到计算$(1 + x + x^2 + x^3)(1 + x^3)$的结果后完毕

    * (6) 把中间变量`tmp`数组的值转到`coe`中并初始化`tmp`

* 继续 (2) 循环直到结束

总而言之言而总之，对于$(1 + x)(1 + x^2)(1 + x^3)$求它的母函数。
就是先构造出$(1)(1 + x)(1 + x^2)(1 + x^3)$
然后按照小学学过的梯等式那样的计算方法依次计算而已
$$$$
