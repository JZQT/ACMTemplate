# 整除与剩余

## 求模运算与求余运算

**求模运算**(modulo)与**求余运算**(remain)是不同的。

通常来说，我们指的`a mod b`运算是**求模**运算，它和**求余**运算在`a`和`b`都是**正整数**的情况下**完全没有区别**。
它们之间仅在`a`与`b`**异号**的情况下结果有区别。

对于**整数**`a`和`b`，**求模**运算和**求余**运算的方法都是两个步骤：

* 求整数商：`c = a / b`
* 计算模或者余数：`m = a - c * b`

在第一个步骤中，**求余**运算在取`c`的值时，**向0方向舍入**，**求模**运算则是**向负无穷方向舍入**。

比如计算`-10 mod 3`，**求余**运算算得的`c`的值为`-3`，而**求模**运算则为`-4`。因此最后计算的结果，**求余**运算为`-1`，而求**模**运算则为`2`。

最后结论是，当`a`与`b`异号时，**求余**运算的结果与`a`同号，而**求模**运算的结果与`b`同号。

**注意：对于程序中的`%`运算符，在不同的环境中含义并不一样，比如在C/C++，JAVA，PHP等，`%`是求余运算，在Python中，`%`是求模运算。**

## 剩余系与模运算

**剩余系**指的是**对于某个特定的正整数n，一个整数集中所有数模n所得的余数域**。

如果一个剩余系中包含了模n情况下所有可能的余数，那么这个剩余系就被称之为是模n的一个**完全剩余系**。
一般来说，模n的完全剩余系就是{0, 1, 2, ···, n-1}。

**简化剩余系**(简称**缩系**)是完全剩余系中**与n互质**的元素。比如当n为12时，缩系就是{1, 5, 7, 11}。

在这里，我们将模n的完全剩余系记作Zn，缩系记作Zn*。

Zn中的每一个元素都代表所有与它同余的整数。比如在Z5中，1代表{1, 6, 11, ···}等所有模5余数为1的数。
Zn中所有整数都代表一个同余等价类，因此**Zn下的运算都称之为模运算**，比如Z5下的模加法`1 + 4 = 0`，模乘法`3 × 4 = 2`。

## 同余

**同余**是**数论**上的一种**等价关系**。
如果两个整数`a`和`b`满足`a - b`能被整数`m`整除(也有这样的说法，如果两个整数`a`和`b`对于模`m`的结果相同)，那么就称`a`和`b`对于模`m`同余。

`a`和`b`对于模`m`同余，记作![同余](http://7rfk4x.com1.z0.glb.clouddn.com/congruence_modulo.png)。
`a`与`b`之间的符号称为**同余符号**，在这里，为了方便我们把类似前面的同余式写作`a = b(mod m)`。

对于**同余**这种等价关系，有以下性质

* 反身性：`a = a(mod m)`
* 对称性：如果`a = b(mod m)`，那么`b = a(mod m)`
* 传递性：如果`a = b(mod m)`、`b = c(mod m)`，那么`a = c(mod m)`

## 欧拉定理

### 概述

在数论中，**欧拉定理**，也称之为**费马-欧拉定理**，是一个关于**同余**的性质。

欧拉定理表示为：

若`n`和`a`为**互质**的两个正整数，那么![欧拉定理](http://7rfk4x.com1.z0.glb.clouddn.com/Euler_Theorem.jpg)，其中**φ(n)**为欧拉函数。

### 应用

利用欧拉定理，有一下推论以及应用

* 欧拉降幂：`a^b mod m = a^(b mod phi(m)) mod m`
* 如果`a`和`m`都是正整数且`a`与`m`互质(`m > 1`)，必有正整数`x`使得`a^x = 1(mod m)`，且满足该等式的最小正整数`x0`必满足`x0|phi(m)`

## 费马小定理

**费马小定理**是**数论**中的一个重要定理，实际上它是**欧拉定理**(数论)的一个特殊情况。它的内容为

如果`p`是质数且`a`与`p`互质，那么`a^(p-1) = 1(mod p)`。

费马小定理之所以是欧拉定理的一种特殊情况是因为素数`x`的欧拉函数值为`x-1`，所以当`p`为素数时可以直接将`p-1`代入欧拉定理的欧拉函数，就成了费马小定理。

## 题集

|题号                   |备注                               |
|:----------------------|:----------------------------------|
|[POJ-1061][PKU1061]    |扩展欧几里德                       |
|[POJ-1995][PKU1995]    |快速幂基础题                       |
|[POJ-3070][PKU3070]    |矩阵快速幂基础题                   |
|[HDOJ-1395][HDU1395]   |欧拉定理                           |
|[HDOJ-1576][HDU1576]   |乘法逆元基础题                     |
|[HDOJ-1905][HDU1905]   |快速幂和判断素数                   |
|[HDOJ-1920][HDU1920]   |多个数LCM                          |
|[HDOJ-4965][HDU4965]   |好题，矩阵快速幂                   |
|[HDOJ-5019][HDU5019]   |求k大GCD                           |
|[UVaOJ-11827][UVa11827]|求GCD，需要字符串处理              |

[PKU1061]:http://poj.org/problem?id=1061
[PKU1995]:http://poj.org/problem?id=1995
[PKU3070]:http://poj.org/problem?id=3070
[HDU1395]:http://acm.hdu.edu.cn/showproblem.php?pid=1395
[HDU1576]:http://acm.hdu.edu.cn/showproblem.php?pid=1576
[HDU1905]:http://acm.hdu.edu.cn/showproblem.php?pid=1905
[HDU1920]:http://acm.hdu.edu.cn/showproblem.php?pid=1920
[HDU4965]:http://acm.hdu.edu.cn/showproblem.php?pid=4965
[HDU5019]:http://acm.hdu.edu.cn/showproblem.php?pid=5019
[UVa11827]:http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=2927
